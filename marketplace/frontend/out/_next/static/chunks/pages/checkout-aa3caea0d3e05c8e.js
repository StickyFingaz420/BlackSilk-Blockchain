(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[222],{7250:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/checkout",function(){return r(175)}])},175:function(e,s,r){"use strict";r.r(s);var t=r(5893),a=r(7294),l=r(1163),i=r(9008),n=r.n(i),c=r(1664),d=r.n(c),o=r(6677),u=r(4413),m=r(4695);s.default=()=>{var e,s,r,i,c,p;let x=(0,l.useRouter)(),{user:h}=(0,u.aC)(),{items:g,total:b,clearCart:y}=(0,u.jD)(),[f,j]=(0,a.useState)(!1),[v,N]=(0,a.useState)(""),[w,k]=(0,a.useState)(""),[S,P]=(0,a.useState)(""),[E,C]=(0,a.useState)("standard"),[O,_]=(0,a.useState)(!1),[B,A]=(0,a.useState)(!0);(0,a.useEffect)(()=>{if(!h){x.push("/login?redirect=/checkout");return}if(0===g.length){x.push("/");return}},[h,g,x]);let handlePlaceOrder=async()=>{if(!O||!w||!v){alert("Please fill in all required fields and agree to terms");return}j(!0);try{var e;let s={buyer:(null==h?void 0:h.id)||"",seller:(null===(e=g[0])||void 0===e?void 0:e.seller)||"",items:g.map(e=>({productId:e.productId,productTitle:e.title,quantity:e.quantity,price:e.price,seller:e.seller})),totalAmount:b,escrowStatus:m.Hb.Pending,status:m.iF.AwaitingPayment,createdAt:Date.now()},r=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(s)});if(r.ok){let e=await r.json();y(),x.push("/order/confirmation?id=".concat(e.id))}else throw Error("Failed to create order")}catch(e){console.error("Order creation failed:",e),alert("Failed to place order. Please try again.")}finally{j(!1)}},q=[{id:"standard",name:"Standard Shipping",time:"7-14 days",price:.001},{id:"express",name:"Express Shipping",time:"3-7 days",price:.003},{id:"overnight",name:"Overnight Delivery",time:"1-2 days",price:.008}];return h&&0!==g.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n(),{children:[(0,t.jsx)("title",{children:"Checkout - BlackSilk Marketplace"}),(0,t.jsx)("meta",{name:"description",content:"Complete your secure order on BlackSilk marketplace"})]}),(0,t.jsx)("div",{className:"min-h-screen bg-gray-900 text-white",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)(d(),{href:"/",className:"text-purple-400 hover:text-purple-300",children:"← Back to Marketplace"}),(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Secure Checkout"}),(0,t.jsx)(o.Uh,{level:m.uk.High})]}),(0,t.jsx)(o.e4,{})]}),B&&(0,t.jsx)(o.kz,{onDismiss:()=>A(!1),customMessage:"Ensure all purchases comply with BlackSilk community standards. Remember: Don't be sick."}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Order Summary"}),(0,t.jsx)("div",{className:"space-y-4 mb-6",children:g.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("img",{src:e.image||"/placeholder.png",alt:e.title,className:"w-16 h-16 object-cover rounded-lg"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"font-medium",children:e.title}),(0,t.jsxs)("p",{className:"text-gray-400",children:["Quantity: ",e.quantity]}),(0,t.jsxs)("p",{className:"text-purple-400",children:[e.price," BSK each"]})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsxs)("p",{className:"font-semibold",children:[(e.price*e.quantity).toFixed(6)," BSK"]})})]},"".concat(e.productId,"-").concat(e.quantity)))}),(0,t.jsxs)("div",{className:"border-t border-gray-700 pt-4 mb-4",children:[(0,t.jsx)("h3",{className:"font-semibold mb-3",children:"Shipping Options"}),(0,t.jsx)("div",{className:"space-y-2",children:q.map(e=>(0,t.jsxs)("label",{className:"flex items-center justify-between p-3 border border-gray-600 rounded-lg cursor-pointer hover:border-purple-500",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("input",{type:"radio",name:"shipping",value:e.id,checked:E===e.id,onChange:e=>C(e.target.value),className:"text-purple-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:e.time})]})]}),(0,t.jsxs)("p",{className:"font-semibold",children:[e.price," BSK"]})]},e.id))})]}),(0,t.jsx)("div",{className:"border-t border-gray-700 pt-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-center text-lg font-semibold",children:[(0,t.jsx)("span",{children:"Total (including shipping):"}),(0,t.jsxs)("span",{className:"text-purple-400",children:[(b+(null!==(i=null===(e=q.find(e=>e.id===E))||void 0===e?void 0:e.price)&&void 0!==i?i:0)).toFixed(6)," BSK"]})]})})]}),(0,t.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Payment & Delivery"}),(0,t.jsxs)("form",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Escrow Wallet Address *"}),(0,t.jsx)("input",{type:"text",value:v,onChange:e=>N(e.target.value),placeholder:"Enter your BSK wallet address for escrow",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Funds will be held in escrow until you confirm delivery"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Encrypted Delivery Address *"}),(0,t.jsx)("textarea",{value:w,onChange:e=>k(e.target.value),placeholder:"Enter your delivery address (will be encrypted)",rows:3,className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Address will be encrypted before storage"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Special Instructions (Optional)"}),(0,t.jsx)("textarea",{value:S,onChange:e=>P(e.target.value),placeholder:"Any special delivery instructions...",rows:2,className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,t.jsx)("h3",{className:"font-semibold mb-2",children:"Escrow Protection"}),(0,t.jsx)(o.Hb,{status:m.Hb.Pending,escrowAddress:"pending...",amount:b+(null!==(c=null===(s=q.find(e=>e.id===E))||void 0===s?void 0:s.price)&&void 0!==c?c:0)}),(0,t.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"Your payment will be secured in escrow until delivery is confirmed. This protects both buyer and seller."})]}),(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("input",{type:"checkbox",checked:O,onChange:e=>_(e.target.checked),className:"mt-1 text-purple-500"}),(0,t.jsxs)("label",{className:"text-sm text-gray-300",children:["I agree to the"," ",(0,t.jsx)(d(),{href:"/terms",className:"text-purple-400 hover:text-purple-300",children:"Terms of Service"})," ","and"," ",(0,t.jsx)(d(),{href:"/privacy",className:"text-purple-400 hover:text-purple-300",children:"Privacy Policy"}),". I understand that all transactions are final and payments are held in escrow."]})]}),(0,t.jsx)("button",{type:"button",onClick:handlePlaceOrder,disabled:f||!O||!w||!v,className:"w-full bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:f?(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,t.jsx)("span",{children:"Processing Order..."})]}):"Place Order (".concat((b+(null!==(p=null===(r=q.find(e=>e.id===E))||void 0===r?void 0:r.price)&&void 0!==p?p:0)).toFixed(6)," BSK)")})]})]})]})]})})]}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-300",children:"Loading checkout..."})]})})}},1163:function(e,s,r){e.exports=r(9974)}},function(e){e.O(0,[774,996,413,531,677,888,179],function(){return e(e.s=7250)}),_N_E=e.O()}]);