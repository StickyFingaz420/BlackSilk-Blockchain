"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[413],{4413:function(e,t,r){r.d(t,{KQ:function(){return useBalance},aC:function(){return useAuth},jD:function(){return useCart},kO:function(){return useNodeStatus},rn:function(){return useProducts},sO:function(){return useWebSocket}});var a=r(7294),s=r(252);function useAuth(){let[e,t]=(0,a.useState)(null),[r,o]=(0,a.useState)(!0),[n,c]=(0,a.useState)(!1);(0,a.useEffect)(()=>{checkAuthentication()},[]);let checkAuthentication=async()=>{try{let e=localStorage.getItem("blacksilk_credentials");e&&(JSON.parse(e),c(!0))}catch(e){console.error("Auth check failed:",e)}finally{o(!1)}},login=async(e,r)=>{o(!0);try{let a=await s.gK.login(e,r);if(a.success&&a.data)return t(a.data),c(!0),{success:!0};return{success:!1,error:a.error}}catch(e){return{success:!1,error:"Login failed"}}finally{o(!1)}};return{user:e,isLoading:r,isAuthenticated:n,login,logout:()=>{s.gK.logout(),t(null),c(!1)}}}function useProducts(e){let[t,r]=(0,a.useState)([]),[o,n]=(0,a.useState)(!0),[c,i]=(0,a.useState)(null);(0,a.useEffect)(()=>{fetchProducts()},[e]);let fetchProducts=async()=>{try{n(!0);let t=await s.gK.getProducts(e);t.success&&t.data?(r(t.data),i(null)):i(t.error||"Failed to fetch products")}catch(e){i("An error occurred while fetching products")}finally{n(!1)}},searchProducts=async t=>{try{n(!0);let a=await s.gK.searchProducts(t,e);a.success&&a.data?(r(a.data),i(null)):i(a.error||"Search failed")}catch(e){i("Search error occurred")}finally{n(!1)}};return{products:t,isLoading:o,error:c,refetch:fetchProducts,search:searchProducts}}function useNodeStatus(){let[e,t]=(0,a.useState)(null),[r,o]=(0,a.useState)(!1),[n,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{fetchNodeStatus();let e=setInterval(fetchNodeStatus,3e4);return()=>clearInterval(e)},[]);let fetchNodeStatus=async()=>{try{let e=await s.gK.getNodeInfo();e.success&&e.data?(t(e.data),o(!0)):o(!1)}catch(e){o(!1)}finally{c(!1)}};return{nodeInfo:e,isOnline:r,isLoading:n}}function useBalance(e){let[t,r]=(0,a.useState)(null),[o,n]=(0,a.useState)(!1),[c,i]=(0,a.useState)(null);(0,a.useEffect)(()=>{e&&fetchBalance()},[e]);let fetchBalance=async()=>{if(e)try{n(!0);let t=await s.gK.getBalance(e);t.success&&t.data?(r(t.data),i(null)):i(t.error||"Failed to fetch balance")}catch(e){i("Error fetching balance")}finally{n(!1)}};return{balance:t,isLoading:o,error:c,refetch:fetchBalance}}function useWebSocket(){let[e,t]=(0,a.useState)([]),[r,o]=(0,a.useState)(!1),[n,c]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=s.gK.connectWebSocket(e=>{t(t=>[...t.slice(-99),e])});return e&&(c(e),e.onopen=()=>o(!0),e.onclose=()=>o(!1),e.onerror=()=>o(!1)),()=>{e&&e.close()}},[]),{messages:e,isConnected:r,sendMessage:e=>{n&&r&&n.send(JSON.stringify(e))}}}function useLocalStorage(e,t){let[r,s]=(0,a.useState)(()=>{try{let r=window.localStorage.getItem(e);return r?JSON.parse(r):t}catch(e){return t}});return[r,t=>{try{let a=t instanceof Function?t(r):t;s(a),window.localStorage.setItem(e,JSON.stringify(a))}catch(e){console.error("Error saving to localStorage:",e)}}]}function useCart(){let[e,t]=useLocalStorage("blacksilk_cart",[]),removeFromCart=(e,r)=>{t(t=>t.filter(t=>!(t.productId===e&&t.seller===r)))},getTotalAmount=()=>e.reduce((e,t)=>e+t.price*t.quantity,0);return{cart:e,items:e,addToCart:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t(t=>{var a;let s=t.findIndex(t=>t.productId===e.id&&t.seller===e.seller);if(s>=0){let e=[...t];return e[s].quantity+=r,e}let o={productId:e.id,title:e.title,price:e.price,quantity:r,seller:e.seller,image:null===(a=e.images)||void 0===a?void 0:a[0],category:e.category};return[...t,o]})},removeFromCart,updateQuantity:(e,r,a)=>{if(a<=0){removeFromCart(e,r);return}t(t=>t.map(t=>t.productId===e&&t.seller===r?{...t,quantity:a}:t))},clearCart:()=>{t([])},getTotalAmount,total:getTotalAmount(),getTotalItems:()=>e.reduce((e,t)=>e+t.quantity,0),isInCart:(t,r)=>e.some(e=>e.productId===t&&e.seller===r),getCartItem:(t,r)=>e.find(e=>e.productId===t&&e.seller===r)}}},252:function(e,t,r){r.d(t,{gK:function(){return s}});var a=r(4695);let BlackSilkMarketplaceAPI=class BlackSilkMarketplaceAPI{async getNodeStatus(){try{let e=await fetch("".concat(this.nodeURL,"/info"));if(!e.ok)throw Error("Node request failed: ".concat(e.statusText));let t=await e.json();return{connected:!0,synced:!0,blockHeight:t.height,difficulty:t.difficulty,connections:t.peers,version:t.version,privacyMode:!0}}catch(e){return{connected:!1,synced:!1,blockHeight:0,difficulty:0,connections:0,version:"unknown",privacyMode:!1}}}async submitTransaction(e){let t=await fetch("".concat(this.nodeURL,"/submit_tx"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Transaction submission failed: ".concat(t.statusText));return await t.json()}async getMempool(){let e=await fetch("".concat(this.nodeURL,"/mempool"));if(!e.ok)throw Error("Mempool request failed: ".concat(e.statusText));return await e.json()}async getBlocks(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=await fetch("".concat(this.nodeURL,"/get_blocks?from_height=").concat(e,"&simple=true"));if(!t.ok)throw Error("Blocks request failed: ".concat(t.statusText));return await t.json()}async login(e,t){try{let r={privateKey:e,recoveryPhrase:t,address:this.derivePublicKey(e),timestamp:Date.now()};localStorage.setItem("blacksilk_credentials",JSON.stringify(r));let a={id:r.address,username:"user_".concat(r.address.slice(0,8)),public_key:r.address,created_at:new Date().toISOString(),last_login:new Date().toISOString(),is_vendor:!1,vendor_rating:0,total_sales:0};return{success:!0,data:a}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Login failed"}}}logout(){localStorage.removeItem("blacksilk_credentials")}async searchProducts(e,t){try{let r=await this.getProducts(t);if(r.success&&r.data){let t=r.data.filter(t=>t.title.toLowerCase().includes(e.toLowerCase())||t.description.toLowerCase().includes(e.toLowerCase())||t.category.toLowerCase().includes(e.toLowerCase()));return{success:!0,data:t}}return{success:!1,error:"Search failed",data:[]}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Search error",data:[]}}}async getNodeInfo(){try{let e=await this.getNodeStatus(),t={chain_height:e.blockHeight||0,peers:e.connections||0,difficulty:e.difficulty||0,hashrate:0,network:"BlackSilk",version:e.version||"unknown"};return{success:!0,data:t}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to get node info"}}}connectWebSocket(e){try{let t=this.nodeURL.replace("http","ws")+"/ws",r=new WebSocket(t);return r.onopen=()=>console.log("WebSocket connected to BlackSilk node"),r.onmessage=t=>{try{let r=JSON.parse(t.data);e(r)}catch(e){console.error("Failed to parse WebSocket message:",e)}},r.onerror=e=>console.error("WebSocket error:",e),r.onclose=()=>console.log("WebSocket disconnected"),r}catch(e){return console.error("Failed to connect WebSocket:",e),null}}async uploadImage(e){try{let t=await this.uploadToIPFS(e);return{success:!0,hash:t}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Upload failed"}}}derivePublicKey(e){return e+"_pub"}async getBalance(e){try{let t=await this.getBlocks(0),r=0;for(let a of t)if(a.transactions)for(let t of a.transactions){if(t.inputs)for(let a of t.inputs)a.address===e&&(r-=a.amount||0);if(t.outputs)for(let a of t.outputs)a.address===e&&(r+=a.amount||0)}let a={confirmed:Math.max(0,r),unconfirmed:0,locked_in_escrow:0};return{success:!0,data:a}}catch(e){return console.error("Failed to get balance:",e),{success:!1,error:e instanceof Error?e.message:"Failed to get balance",data:{confirmed:0,unconfirmed:0,locked_in_escrow:0}}}}async uploadToIPFS(e){let t=new FormData;t.append("file",e);let r=await fetch("".concat(this.ipfsGateway,"/api/v0/add"),{method:"POST",body:t});if(!r.ok)throw Error("IPFS upload failed: ".concat(r.statusText));let a=await r.json();return a.Hash}async getFromIPFS(e){let t=await fetch("".concat(this.ipfsGateway,"/ipfs/").concat(e));if(!t.ok)throw Error("IPFS retrieval failed: ".concat(t.statusText));return t.text()}async createProduct(e){try{let t=[];if(e.images&&e.images.length>0)for(let r of e.images)if("string"==typeof r&&(r.startsWith("data:")||r.startsWith("blob:"))){let e=await fetch(r),a=await e.blob(),s=new File([a],"image.jpg",{type:a.type}),o=await this.uploadToIPFS(s);t.push("ipfs://".concat(o))}else t.push(r);let r={...e,id:this.generateId(),images:t,createdAt:Date.now()},a={txid:this.generateId(),from:e.seller,to:e.seller,amount:0,fee:100,timestamp:new Date().toISOString(),confirmations:0},s=await this.submitTransaction(a);if(s.success)return{success:!0,data:r};return{success:!1,error:s.message}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getProducts(e){try{let t=[{id:"1",seller:"vendor123",title:"Privacy Phone Case",description:"Faraday cage phone case for maximum privacy",category:"electronics",price:50,currency:"BLK",stock:10,images:["ipfs://QmHash1"],createdAt:Date.now()-864e5,isActive:!0,stealthRequired:!0,escrowRequired:!0},{id:"2",seller:"vendor456",title:"Anonymous VPN Service",description:"1-year anonymous VPN subscription",category:"digital",price:100,currency:"BLK",stock:100,images:["ipfs://QmHash2"],createdAt:Date.now()-1728e5,isActive:!0,stealthRequired:!0,escrowRequired:!1}],r=t;return e&&(e.category&&(r=r.filter(t=>t.category===e.category)),void 0!==e.min_price&&(r=r.filter(t=>t.price>=e.min_price)),void 0!==e.max_price&&(r=r.filter(t=>t.price<=e.max_price)),e.vendor&&(r=r.filter(t=>t.seller===e.vendor))),{success:!0,data:r}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error",data:[]}}}async getProduct(e){try{let t=await this.getProducts();if(t.success&&t.data){let r=t.data.find(t=>t.id===e);return{success:!0,data:r||null}}return{success:!1,error:"Failed to fetch products",data:null}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error",data:null}}}async createOrder(e){try{let t={...e,id:this.generateId(),status:a.iF.AwaitingPayment,createdAt:Date.now()},r={txid:this.generateId(),from:e.buyer,to:e.seller,amount:e.totalAmount,fee:100,timestamp:new Date().toISOString(),confirmations:0},s=await this.submitTransaction(r);if(s.success)return{success:!0,data:t};return{success:!1,error:s.message}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getOrders(e){try{let t=e;if(!t){let e=localStorage.getItem("blacksilk_credentials");if(e){let r=JSON.parse(e);t=r.address}}if(!t)return{success:!1,error:"User address required",data:[]};let r=[{id:"1",buyer:t,seller:"vendor123",items:[{productId:"1",productTitle:"Privacy Phone Case",quantity:1,price:50,seller:"vendor123"}],totalAmount:50,escrowStatus:a.Hb.Funded,status:a.iF.Processing,createdAt:Date.now()-864e5}];return{success:!0,data:r}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error",data:[]}}}async getCategories(){return{success:!0,data:[{id:"electronics",name:"Electronics",description:"Electronic devices and gadgets",icon:"\uD83D\uDCF1",count:150},{id:"clothing",name:"Clothing",description:"Fashion and apparel",icon:"\uD83D\uDC55",count:200},{id:"books",name:"Books",description:"Books and publications",icon:"\uD83D\uDCDA",count:75},{id:"home",name:"Home & Garden",description:"Home improvement and gardening",icon:"\uD83C\uDFE0",count:100},{id:"sports",name:"Sports & Outdoors",description:"Sports equipment and outdoor gear",icon:"âš½",count:80},{id:"automotive",name:"Automotive",description:"Car parts and accessories",icon:"\uD83D\uDE97",count:60},{id:"digital",name:"Digital Goods",description:"Software, games, and digital content",icon:"\uD83D\uDCBE",count:120},{id:"services",name:"Services",description:"Professional and personal services",icon:"\uD83D\uDD27",count:90}]}}async createEscrow(e,t,r,s){try{let e={contract_id:this.generateId(),buyer:r,seller:s,arbiter:"system_arbiter",amount:t,status:a.Hb.Pending,signatures:[],created_at:new Date().toISOString()},o={txid:this.generateId(),from:r,to:this.escrowContractAddress,amount:t,fee:100,timestamp:new Date().toISOString(),confirmations:0},n=await this.submitTransaction(o);if(n.success)return{success:!0,data:e};return{success:!1,error:n.message}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}generateId(){return Math.random().toString(36).substr(2,9)+Date.now().toString(36)}async healthCheck(){let e={node:!1,ipfs:!1,marketplace:!1};try{let t=await this.getNodeStatus();e.node=t.connected}catch(t){e.node=!1}try{let t=await fetch("".concat(this.ipfsGateway,"/api/v0/version"),{method:"POST"});e.ipfs=t.ok}catch(t){e.ipfs=!1}return e.marketplace=e.node,e}generateAddressFromPrivateKey(e){return"BSK"+e.substring(0,40)}constructor(e){this.nodeURL=e.nodeURL||"http://localhost:8545",this.ipfsGateway=e.ipfsGateway||"http://localhost:8080",this.escrowContractAddress=e.escrowContractAddress||""}};let s=new BlackSilkMarketplaceAPI({nodeURL:"http://localhost:8545",ipfsGateway:"http://localhost:8080",escrowContractAddress:"escrow_contract_address"})},4695:function(e,t,r){var a,s,o,n,c,i;r.d(t,{Hb:function(){return o},iF:function(){return s},uk:function(){return a}}),(n=a||(a={})).Low="Low",n.Medium="Medium",n.High="High",n.Maximum="Maximum",(c=s||(s={})).AwaitingPayment="AwaitingPayment",c.Paid="Paid",c.Processing="Processing",c.Shipped="Shipped",c.Delivered="Delivered",c.Completed="Completed",c.Disputed="Disputed",c.Cancelled="Cancelled",c.Refunded="Refunded",(i=o||(o={})).Pending="pending",i.Funded="funded",i.Completed="completed",i.Disputed="disputed",i.Refunded="refunded",i.Voting="voting",i.Resolved="resolved"}}]);